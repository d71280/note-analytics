<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>å‰Šé™¤ãƒœã‚¿ãƒ³ãƒ†ã‚¹ãƒˆ</title>
    <style>
        body { font-family: sans-serif; padding: 20px; }
        button { padding: 10px 20px; margin: 10px; font-size: 16px; }
        .delete-btn { background: #ef4444; color: white; border: none; border-radius: 5px; cursor: pointer; }
        .delete-btn:hover { background: #dc2626; }
        #log { background: #f3f4f6; padding: 15px; margin-top: 20px; white-space: pre-wrap; }
    </style>
</head>
<body>
    <h1>GPTså‰Šé™¤ãƒœã‚¿ãƒ³å‹•ä½œãƒ†ã‚¹ãƒˆ</h1>
    <p>ã“ã‚Œã¯å®Ÿéš›ã®Vercelç’°å¢ƒã§ã®å‰Šé™¤ãƒ†ã‚¹ãƒˆã§ã™ã€‚</p>
    
    <div id="contents"></div>
    <div id="log"></div>

    <script>
    const log = (msg) => {
        document.getElementById('log').textContent += msg + '\n';
    };

    async function loadContents() {
        log('ğŸ“‹ ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å–å¾—ä¸­...');
        const res = await fetch('/api/gpts/contents');
        const data = await res.json();
        log(`âœ… ${data.total}ä»¶ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å–å¾—`);
        
        const div = document.getElementById('contents');
        div.innerHTML = '<h2>GPTsã‚³ãƒ³ãƒ†ãƒ³ãƒ„</h2>';
        
        data.contents.forEach(item => {
            const card = document.createElement('div');
            card.style.border = '1px solid #ccc';
            card.style.padding = '10px';
            card.style.margin = '10px 0';
            card.innerHTML = `
                <p>${item.content.substring(0, 50)}...</p>
                <p>ID: ${item.id}</p>
                <button class="delete-btn" onclick="deleteContent('${item.id}')">å‰Šé™¤</button>
            `;
            div.appendChild(card);
        });
    }

    async function deleteContent(id) {
        if (!confirm('å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) return;
        
        log(`ğŸ—‘ï¸ å‰Šé™¤ä¸­: ${id}`);
        
        try {
            const res = await fetch('/api/gpts-actions', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ action: 'delete', id })
            });
            
            if (res.ok) {
                const data = await res.json();
                log(`âœ… å‰Šé™¤æˆåŠŸ: ${JSON.stringify(data)}`);
                setTimeout(loadContents, 1000);
            } else {
                log(`âŒ å‰Šé™¤å¤±æ•—: ${res.status}`);
                const text = await res.text();
                log(text);
            }
        } catch (err) {
            log(`âŒ ã‚¨ãƒ©ãƒ¼: ${err.message}`);
        }
    }

    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«å®Ÿè¡Œ
    loadContents();
    </script>
</body>
</html>