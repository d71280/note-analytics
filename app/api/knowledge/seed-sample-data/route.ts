import { NextRequest, NextResponse } from 'next/server'
import { createClient } from '@/lib/supabase/server'

const sampleKnowledgeData = [
  {
    title: '脳内OS強化のすゝめ マーケティング視点導入',
    content: `脳内OS強化とは、情報処理能力を向上させ、思考を整理し、効率的に学習するためのシステム的なアプローチです。

【核心概念】
1. 情報の入力・処理・出力の最適化
2. 認知負荷の軽減と集中力の向上
3. 知識の体系化と応用力の強化

【マーケティング視点での活用】
- 顧客心理の理解と予測
- データ分析と意思決定の高速化
- 創造的思考と戦略立案の向上

【実践方法】
1. 情報収集の効率化
2. パターン認識能力の向上
3. 記憶と想起の最適化
4. 創造性と論理的思考のバランス

脳内OSを強化することで、マーケティング戦略の立案から実行まで、より効果的かつ効率的に行えるようになります。`,
    content_type: 'note',
    tags: ['脳内OS', 'マーケティング', '学習', '効率化', '戦略思考']
  },
  {
    title: 'AI活用による生産性向上術',
    content: `ChatGPTやGrokなどのAIツールを効果的に活用して、日常業務の生産性を大幅に向上させる方法について詳しく解説します。

【AIツールの選び方】
- タスクに応じた最適なツールの選択
- 無料版と有料版の使い分け
- セキュリティとプライバシーの考慮

【プロンプトエンジニアリング】
1. 明確で具体的な指示の重要性
2. 段階的な質問の組み立て方
3. コンテキストの適切な提供
4. 結果の検証と改善方法

【業務自動化の実践】
- ルーチンワークの自動化
- データ分析とレポート作成
- コミュニケーションの効率化
- クリエイティブ作業の支援

【注意点とベストプラクティス】
- AIの限界を理解する
- 人間の判断力とのバランス
- 継続的な学習と適応
- 倫理的配慮の重要性`,
    content_type: 'blog',
    tags: ['AI', 'ChatGPT', 'Grok', '生産性', '業務効率化', 'プロンプトエンジニアリング']
  },
  {
    title: 'マーケティング事例100連発',
    content: `成功したマーケティング事例を100個紹介し、その成功要因と応用方法を解説します。

【水の事例】
1. Volvic: 「美味しい水」というシンプルな価値提案
2. いろはす: 環境に配慮したブランドポジショニング
3. evian: 高級感と健康イメージの組み合わせ

【食品・飲料の事例】
- コカ・コーラ: 感情に訴えるブランドストーリー
- スターバックス: 第三の場所としての価値創造
- ユニクロ: シンプルで高品質なファッション

【テクノロジーの事例】
- Apple: デザインとユーザー体験の重視
- Tesla: 持続可能性とイノベーションの融合
- Netflix: データ駆動型のコンテンツ戦略

【共通する成功要因】
1. 明確なターゲット設定
2. 差別化された価値提案
3. 一貫したブランドメッセージ
4. 顧客中心のアプローチ
5. 継続的なイノベーション`,
    content_type: 'document',
    tags: ['マーケティング', '事例', 'ブランディング', '戦略', '成功要因']
  },
  {
    title: '強み発見の全体像',
    content: `強みを発見し、それを最大限に活用するための包括的なフレームワークを紹介します。

【強みとは何か】
- 自然にできること
- エネルギーが湧いてくる活動
- 継続的に改善できる能力
- 他者に価値を提供できる分野

【特徴を捉える方法】
1. 自己観察と振り返り
2. 他者からのフィードバック
3. パフォーマンスデータの分析
4. 感情とエネルギーレベルの監視

【戦略的思考の全体像】
- 外部環境の分析（機会と脅威）
- 内部資源の評価（強みと弱み）
- 競合優位性の構築
- 持続可能な成長戦略

【マーケティング思考の全体像】
- 顧客価値の創造
- 市場機会の特定
- ブランドポジショニング
- 効果的なコミュニケーション戦略

【My Brandの作り方】
1. 個人の価値観とミッションの明確化
2. 独自の専門性と経験の整理
3. ターゲットオーディエンスの定義
4. 一貫したメッセージの構築
5. 継続的なブランド強化`,
    content_type: 'note',
    tags: ['強み発見', '自己分析', '戦略思考', 'マーケティング', 'ブランディング']
  },
  {
    title: 'ヒアリング能力覚醒 指南書',
    content: `コミュニケーションの原点であるヒアリング能力を向上させるための実践的なガイドです。

【ヒアリング能力向上の目的】
1. コミュニケーションの原点
   - 相手の話を聞くことの重要性
   - 理解と共感の基盤
   - 信頼関係の構築

2. ヒアリング能力×○○
   - 営業: 顧客ニーズの正確な把握
   - マネジメント: チームメンバーの状況理解
   - カウンセリング: クライアントの課題特定
   - 教育: 学習者の理解度確認

【コミュニケーションの全体像】
1. 情報の仕入れ（ヒアリング）
   - 積極的傾聴の技術
   - 質問の種類と使い分け
   - 非言語コミュニケーションの読み取り

2. 情報の料理（理解・分析）
   - 話の要点の整理
   - 感情と事実の分離
   - 背景と文脈の理解

3. 情報の提供（フィードバック）
   - 理解の確認
   - 適切な反応と共感
   - 建設的な提案

【実践テクニック】
- オープンクエスチョンとクローズドクエスチョン
- パラフレーズと要約
- 沈黙の活用
- 非言語コミュニケーションの活用`,
    content_type: 'guidebook',
    tags: ['ヒアリング', 'コミュニケーション', '傾聴', '営業', 'マネジメント']
  },
  {
    title: '2025年 コンテンツ戦略の最新トレンド',
    content: `2025年に向けたコンテンツ戦略の最新トレンドと実践方法を詳しく解説します。

【主要トレンド】
1. AI活用コンテンツ
   - パーソナライゼーションの高度化
   - 自動生成コンテンツの品質向上
   - マルチモーダルコンテンツの普及

2. 短編動画の重要性
   - TikTok、Instagram Reels、YouTube Shorts
   - エンゲージメント重視のコンテンツ設計
   - トレンドへの迅速な対応

3. 音声コンテンツの台頭
   - ポッドキャストの多様化
   - 音声SNSの活用
   - 音声検索の最適化

【成功戦略】
- データ駆動型のコンテンツ計画
- オムニチャネル戦略の実装
- ユーザー生成コンテンツ（UGC）の活用
- インタラクティブコンテンツの導入

【測定と最適化】
- エンゲージメント指標の見直し
- コンテンツROIの測定
- A/Bテストの継続実施
- フィードバックループの構築`,
    content_type: 'analysis',
    tags: ['コンテンツ戦略', '2025年', 'トレンド', 'AI', '動画', '音声']
  },
  {
    title: '効果的なSNS投稿の心理学',
    content: `SNSで高いエンゲージメントを得るための心理学的アプローチを解説します。

【人間心理の理解】
1. 社会的証明の原理
   - 他者の行動に影響される心理
   - いいね数やシェア数の重要性
   - インフルエンサーの効果

2. 感情喚起の重要性
   - ポジティブ感情の共有
   - 驚きや好奇心の活用
   - 共感を呼ぶストーリーテリング

3. 即座の満足感
   - 即座に価値を提供
   - 実用的な情報の共有
   - 視覚的な魅力の活用

【投稿タイミングの最適化】
- ターゲットオーディエンスの行動パターン分析
- プラットフォーム別の最適時間帯
- 季節やイベントとの連動

【コンテンツの種類と効果】
- 教育コンテンツ: 信頼性の構築
- エンターテイメント: エンゲージメント向上
- インスピレーション: 感情的なつながり
- 実用情報: 価値の提供`,
    content_type: 'research',
    tags: ['SNS', '心理学', 'エンゲージメント', '投稿戦略', '人間心理']
  },
  {
    title: '持続可能なビジネスモデルの構築',
    content: `長期的に成功し続けるビジネスモデルの設計と実装方法を解説します。

【持続可能性の要素】
1. 経済的持続可能性
   - 収益性の確保
   - コスト構造の最適化
   - キャッシュフローの管理

2. 社会的持続可能性
   - ステークホルダーとの関係構築
   - 社会的価値の創造
   - 透明性と責任の確保

3. 環境的持続可能性
   - 環境負荷の軽減
   - 循環型経済の実現
   - 再生可能資源の活用

【ビジネスモデルキャンバス】
- 価値提案の明確化
- 顧客セグメントの特定
- チャネルの最適化
- 収益ストリームの多様化
- 主要リソースと活動の整理

【イノベーション戦略】
- 破壊的イノベーションの機会探索
- 持続的イノベーションの実践
- オープンイノベーションの活用
- デジタルトランスフォーメーション`,
    content_type: 'strategy',
    tags: ['ビジネスモデル', '持続可能性', 'イノベーション', '戦略', '長期的成功']
  },
  {
    title: 'リーダーシップ開発の実践ガイド',
    content: `効果的なリーダーシップを開発し、実践するための包括的なガイドです。

【リーダーシップの本質】
- ビジョンの提示と共有
- チームの能力開発
- 変化のマネジメント
- 意思決定の質向上

【リーダーシップスタイル】
1. 変革型リーダーシップ
   - ビジョンとインスピレーション
   - 創造性とイノベーションの促進
   - 個人的配慮と成長支援

2. サーバントリーダーシップ
   - 他者の成長を優先
   - 謙虚さと共感
   - コミュニティの構築

3. 適応型リーダーシップ
   - 状況に応じた柔軟性
   - 学習と適応の継続
   - 複雑性への対応

【実践スキル】
- 効果的なコミュニケーション
- フィードバックの提供
- コンフリクトマネジメント
- チームビルディング
- ストレステストとレジリエンス`,
    content_type: 'guidebook',
    tags: ['リーダーシップ', 'マネジメント', 'チームビルディング', '組織開発', '人材育成']
  },
  {
    title: 'デジタルマーケティングの最新手法',
    content: `2025年のデジタルマーケティングで成功するための最新手法と戦略を紹介します。

【主要チャネルと戦略】
1. 検索エンジンマーケティング（SEM）
   - SEO最適化の最新トレンド
   - 音声検索への対応
   - ローカルSEOの重要性

2. ソーシャルメディアマーケティング
   - プラットフォーム別戦略
   - インフルエンサーマーケティング
   - コミュニティマーケティング

3. コンテンツマーケティング
   - 動画コンテンツの活用
   - インタラクティブコンテンツ
   - パーソナライゼーション

【データ活用と分析】
- 顧客データプラットフォーム（CDP）
- マーケティングオートメーション
- 予測分析と機械学習
- リアルタイム分析

【プライバシーとコンプライアンス】
- GDPR、CCPAへの対応
- プライバシーファーストのアプローチ
- 透明性と信頼の構築`,
    content_type: 'strategy',
    tags: ['デジタルマーケティング', 'SEO', 'SNS', 'コンテンツ', 'データ分析']
  }
]

export async function POST(request: NextRequest) {
  console.log('=== Seed Sample Knowledge Data API Start ===')
  
  try {
    const supabase = createClient()
    
    // 既存のデータ数を確認
    const { count: existingCount } = await supabase
      .from('knowledge_base')
      .select('*', { count: 'exact', head: true })

    if (existingCount && existingCount > 0) {
      return NextResponse.json({
        success: false,
        message: `既に${existingCount}件の知識データが存在します。`,
        existingCount
      })
    }

    // サンプルデータを挿入
    const { data, error } = await supabase
      .from('knowledge_base')
      .insert(sampleKnowledgeData)
      .select()

    if (error) {
      console.error('Sample data insertion error:', error)
      return NextResponse.json(
        { 
          success: false,
          error: 'サンプルデータの挿入に失敗しました',
          details: error.message
        },
        { status: 500 }
      )
    }

    console.log(`Successfully inserted ${data?.length || 0} sample knowledge items`)

    return NextResponse.json({
      success: true,
      message: `${data?.length || 0}件のサンプル知識データを追加しました`,
      insertedCount: data?.length || 0,
      items: data?.map(item => ({
        title: item.title,
        contentType: item.content_type,
        tags: item.tags
      }))
    })

  } catch (error) {
    console.error('=== Seed Sample Data Error ===', error)
    return NextResponse.json(
      { 
        success: false,
        error: 'サンプルデータの追加中にエラーが発生しました',
        details: error instanceof Error ? error.message : 'Unknown error'
      },
      { status: 500 }
    )
  }
} 